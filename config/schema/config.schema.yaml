$schema: "https://json-schema.org/draft/2020-12/schema"

description: Configuration schema for Q100 variant benchmark pipeline

type: object

required:
  - chromosomes
  - benchmarksets
  - references

properties:
  chromosomes:
    type: object
    description: Chromosome sets for analysis
    required:
      - autosomes
      - sex
    properties:
      autosomes:
        type: array
        items:
          type: integer
        description: Autosome numbers
      sex:
        type: array
        items:
          type: string
        description: Sex chromosome names

  benchmarksets:
    type: object
    description: Benchmark sets for analysis
    patternProperties:
      "^(v5q|v421|cmrg|v06|tr)_":
        type: object
        required:
          - vcf
        properties:
          ref:
            type: string
            description: Reference genome version (e.g., GRCh37, GRCh38)
          vcf:
            anyOf:
              - type: string
                description: Path to VCF file
                pattern: ".*\\.vcf\\.gz$"
              - type: object
                required:
                  - url
                anyOf:
                  - required: [md5]
                  - required: [sha256]
                properties:
                  url:
                    type: string
                    description: URL to VCF file
                  md5:
                    type: string
                    pattern: "^[a-f0-9]{32}$"
                    description: MD5 checksum of the VCF file
                  sha256:
                    type: string
                    pattern: "^[a-f0-9]{64}$"
                    description: SHA256 checksum of the VCF file
          bed:
            anyOf:
              - type: string
                pattern: ".*\\.bed(\\.gz)?$"
              - type: object
                required:
                  - url
                anyOf:
                  - required: [md5]
                  - required: [sha256]
                properties:
                  url:
                    type: string
                    description: URL to BED file
                  md5:
                    type: string
                    pattern: "^[a-f0-9]{32}$"
                    description: MD5 checksum of the BED file
                  sha256:
                    type: string
                    pattern: "^[a-f0-9]{64}$"
                    description: SHA256 checksum of the BED file
              - type: "null"
            description: Path to BED file (optional for pre-filtered benchmarks)
          dip_bed:
            type: object
            required:
              - url
            anyOf:
              - required: [md5]
              - required: [sha256]
            properties:
              url:
                type: string
                description: URL to dip.bed file
              md5:
                type: string
                pattern: "^[a-f0-9]{32}$"
                description: MD5 checksum
              sha256:
                type: string
                pattern: "^[a-f0-9]{64}$"
                description: SHA256 checksum
          exclusions:
            type: array
            description: Exclusion regions
            items:
              type: object
              required:
                - name
                - type
                - files
              properties:
                name:
                  type: string
                type:
                  enum: [single, pair]
                description:
                  type: string
                files:
                  type: array
                  items:
                    type: object
                    required:
                      - url
                    anyOf:
                      - required: [md5]
                      - required: [sha256]
                    properties:
                      url:
                        type: string
                      md5:
                        type: string
                        pattern: "^[a-f0-9]{32}$"
                      sha256:
                        type: string
                        pattern: "^[a-f0-9]{64}$"
    minProperties: 1

  references:
    type: object
    description: Reference files and other resources
    patternProperties:
      "^[a-zA-Z0-9_\\.]+$":
        type: object
        required:
          - url
        properties:
          url:
            type: string
            description: Remote URL for download
          md5:
            type: string
            pattern: "^[a-f0-9]{32}$"
            description: MD5 checksum
          sha256:
            type: string
            pattern: "^[a-f0-9]{64}$"
            description: SHA256 checksum
          stratifications:
            type: object
            description: Genome stratification BED files for this reference
            patternProperties:
              "^[A-Z0-9]+$":
                type: object
                required:
                  - url
                anyOf:
                  - required: [md5]
                  - required: [sha256]
                properties:
                  url:
                    type: string
                    description: URL to stratification BED file
                  description:
                    type: string
                    description: Description of this stratification
                  md5:
                    type: string
                    pattern: "^[a-f0-9]{32}$"
                    description: MD5 checksum
                  sha256:
                    type: string
                    pattern: "^[a-f0-9]{64}$"
                    description: SHA256 checksum
  chr8_synteny:
    type: object
    description: Optional configuration for chr8 synteny figure generation
    required:
      - ref
      - mat
      - pat
    properties:
      ref:
        type: string
        description: Path to full reference FASTA
      mat:
        type: string
        description: Path to full maternal FASTA
      pat:
        type: string
        description: Path to full paternal FASTA
      chrom:
        type: string
        description: Chromosome name to extract and display (default chr8)
      ref_contig:
        type: string
        description: Optional reference FASTA contig override
      mat_contig:
        type: string
        description: Optional maternal FASTA contig override
      pat_contig:
        type: string
        description: Optional paternal FASTA contig override
      zoom_padding:
        type: integer
        minimum: 0
        description: Flanking bp for zoom panel around detected inversion
      min_inversion_size:
        type: integer
        minimum: 0
        description: Minimum inversion size (bp) for automatic selection
      threads:
        type: integer
        minimum: 1
        description: Threads for minimap2 and SyRI
  comparisons:
    type: object
    description: Benchmark comparison configurations
    patternProperties:
      "^[a-zA-Z0-9_]+$":
        type: object
        required:
          - type
          - new_benchmark
          - old_benchmark
          - ref
        properties:
          type:
            type: string
            enum: ["smvar", "stvar"]
            description: Type of variants (smvar or stvar)
          new_benchmark:
            type: string
            description: ID of the new benchmark set (from benchmarksets)
          old_benchmark:
            type: string
            description: ID of the old benchmark set (from benchmarksets)
          ref:
            type: string
            description: Reference genome ID (from references)
